<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Add Google Fonts link BEFORE any styles -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>



/* Add this to your existing CSS */
.carousel-indicators {
    display: flex;
    justify-content: center;
    margin-top: 15px;
    margin-bottom: 15px; /* Add space below the dots */
    gap: 8px;
}

/* Make hover effects consistent between both buttons */
.select-file-button:hover, .analyze-button:hover {
    background: linear-gradient(45deg, #0056b3, #007bff) !important;
    box-shadow: 0 0 12px rgba(0, 170, 255, 0.7) !important; /* Enhanced aqua glow */
    transform: scale(1.05) !important; /* Slight grow effect */
}



/* Modal content styling - make boxes larger and darken background */
.modal-overlay {
    background-color: rgba(0, 0, 0, 0.8); /* Darkened background */
}

.modal-content {
    background: rgba(31, 43, 80, 0.95); /* Darker blue background similar to reference */
    border-radius: 16px;
    padding: 40px; /* Increased padding */
    width: 95%;
    max-width: 750px; /* Increased max-width */
    box-shadow: 0 0 40px rgba(0, 170, 255, 0.4); /* Enhanced glow */
    border: 1px solid rgba(0, 170, 255, 0.4); /* Subtle border */
}

/* File upload and text input boxes styling to match reference */
.file-upload-box, .text-input-box {
    background-color: rgba(31, 43, 80, 0.95); /* Darker blue */
    border-radius: 12px;
    padding: 30px 25px; /* Increased padding */
    margin-top: 10px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3); /* Enhanced shadow */
    max-width: 100%;
    text-align: center;
    position: relative;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

/* Enhance labels for better visibility */
.file-upload-box label, .text-input-box label {
    color: white !important;
    font-size: 1.5em !important; /* Larger font size */
    font-weight: 600 !important;
    margin-bottom: 15px !important;
    display: block !important;
}

/* Style the drop area to match the reference */
#dragDropText {
    border: 2px dotted rgba(0, 170, 255, 0.6) !important; /* Brighter border */
    padding: 70px 20px !important; /* Larger padding */
    border-radius: 8px !important;
    color: rgba(255, 255, 255, 0.8) !important;
    font-size: 16px !important;
    margin: 20px 0 !important; /* Added margin */
}

/* Style the buttons */
.select-file-button, .analyze-button {
    background: linear-gradient(45deg, #007bff, #00aaff) !important;
    color: white !important;
    border: none !important;
    padding: 12px 15px !important; /* Larger padding */
    border-radius: 8px !important;
    font-size: 16px !important;
    font-weight: 500 !important;
    width: 100% !important;
    margin-top: 20px !important;
    cursor: pointer !important;
    transition: transform 0.2s, box-shadow 0.2s !important;
}

/* Style textarea to match the boxes */
#text_input {
    background-color: rgba(255, 255, 255, 0.15) !important;
    color: white !important;
    border: 1px solid rgba(255, 255, 255, 0.3) !important;
    border-radius: 8px !important;
    padding: 15px !important;
    font-size: 16px !important;
    width: 100% !important;
    min-height: 150px !important; /* Taller textarea */
    margin: 20px 0 !important;
}




/* Modify your CSS to hide the select file button when a file is attached */
.modal-content .select-file-button {
    display: inline-block;
    margin-top: 15px;
    background: linear-gradient(45deg, #007bff, #00aaff);
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
    width: 100%;
    box-sizing: border-box;
    font-size: 16px;
    text-align: center;
}

/* Only hide the select button when file name is visible AND not empty */
.file-name:not(:empty):not([style*="display: none"]) ~ .select-file-button {
    display: none !important;
}

/* Add this to your CSS to properly handle modal stacking */
.modal-content {
    position: relative;
    z-index: 1001; /* Higher than modal-overlay z-index */
    background: rgba(0, 0, 0, 0.8);
    border-radius: 12px;
    padding: 30px;
    width: 90%;
    max-width: 600px;
    box-shadow: 0 0 30px rgba(0, 170, 255, 0.3);
    transform: scale(0.9);
    transition: transform 0.3s ease;
    border: 1px solid rgba(0, 170, 255, 0.3);
}

/* Ensure only one modal shows at a time */
.modal-overlay.active {
    opacity: 1;
    visibility: visible;
    z-index: 1000;
}

/* Prevent content from stacking incorrectly inside modals */
.modal-overlay .file-upload-box,
.modal-overlay .text-input-box {
    position: relative;
    z-index: 1;
    background: transparent;
    box-shadow: none;
    border: none;
    padding: 0;
}

/* Modal overlay styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 0 30px rgba(0, 170, 255, 0.3);
            transform: scale(0.9);
            transition: transform 0.3s ease;
            position: relative;
            border: 1px solid rgba(0, 170, 255, 0.3);
        }
        
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 20px;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .close-modal:hover {
            color: #00aaff;
        }

        .hidden-admin {
            display: none !important;
            visibility: hidden !important;
            width: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
            position: absolute !important;
            left: -9999px !important;
        }

        /* Animation for fading in the boxes */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Style for switch button */
        .switch-input-button {
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .switch-input-button:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .switch-input-button i {
            margin-right: 5px;
        }

/* IMPORTANT: Final override for hover effect with "Click to use" text */
.instruction-item {
    cursor: pointer;
    position: relative;
    overflow: visible !important;
}

/* Enhanced blue bar at the top */
.instruction-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px; /* Slightly thicker */
    background: linear-gradient(90deg, #007bff, #00aaff);
    transform: scaleX(0.3);
    transform-origin: left;
    transition: transform 0.5s, box-shadow 0.5s;
    z-index: 1001; /* Higher than the overlay to show through it */
    box-shadow: 0 0 8px rgba(0, 170, 255, 0.5); /* Add glow effect */
}

.instruction-item:hover::before {
    transform: scaleX(1);
    box-shadow: 0 0 15px rgba(0, 170, 255, 0.8); /* Enhanced glow on hover */
}

/* "Click to use" overlay with reduced opacity */
.instruction-item::after {
    content: "Click to use" !important;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 70, 145, 0.6) !important; /* Slightly more transparent */
    color: white !important;
    font-size: 24px !important;
    font-weight: 600 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    opacity: 0;
    transition: opacity 0.3s ease;
    border-radius: 12px;
    pointer-events: none;
    z-index: 1000;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

.instruction-item:hover::after {
    opacity: 1 !important;
}

/* Make sure the box still moves up on hover */
.instruction-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    z-index: 10;
}

/* Enhanced hover effects for instruction boxes */
@keyframes fadeInOverlay {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

.instruction-item:hover .instruction-icon-wrapper {
    transform: scale(1.1);
    box-shadow: 0 0 20px rgba(0, 170, 255, 0.6);
    z-index: 2;
}

.instruction-item .instruction-text,
.instruction-item .instruction-icon-wrapper {
    position: relative;
    z-index: 1;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

        /* Add this to position the welcome section properly */
        .welcome-section {
            position: relative;
            z-index: 1;
            margin-top: 30px;
        }

        /* Section makes Upload and Quick Check Boxes appear upon click */
        /* Add highlighting and animation for the boxes */
        .highlight-box {
            border: 2px solid rgba(0, 170, 255, 0.7) !important;
            box-shadow: 0 0 15px rgba(0, 170, 255, 0.5) !important;
        }

        @keyframes pulseBox {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.03);
            }
            100% {
                transform: scale(1);
            }
        }

        .pulse-animation-box {
            animation: pulseBox 0.6s ease-in-out 3;
        }

        /* Make the instruction items look clickable */
        .instruction-item {
            cursor: pointer;
        }

        .instruction-item:hover {
            transform: translateY(-5px);
        }

        .instruction-item:hover::after {
            transform: scaleX(1);
        }


/* Add this to position the welcome section properly */
.welcome-section {
    position: relative;
    z-index: 1;
    margin-top: 30px;
}

/* Section makes Upload and Quick Check Boxes appear upon click */
/* Add highlighting and animation for the boxes */
.highlight-box {
    border: 2px solid rgba(0, 170, 255, 0.7) !important;
    box-shadow: 0 0 15px rgba(0, 170, 255, 0.5) !important;
}





/ HERE






/* CSS for carousel subheading feature */
.message-carousel-container {
    margin: 30px auto;
    max-width: 900px;
    text-align: center;
    position: relative;
}

.message-carousel {
    height: 50px;
    overflow: hidden;
    position: relative;
}

.carousel-slide {
    position: absolute;
    width: 100%;
    text-align: center;
    font-size: 22px;
    font-weight: 400;
    color: rgba(255, 255, 255, 0.9);
    opacity: 0;
    top: 0;
    left: 0;
    transform: translateY(20px);
    transition: opacity 0.8s, transform 0.8s;
    font-style: italic;
}

.carousel-slide.active {
    opacity: 1;
    transform: translateY(0);
}

.carousel-indicators {
    display: flex;
    justify-content: center;
    margin-top: 15px;
    gap: 8px;
}

.indicator {
    width: 8px;
    height: 8px;
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    cursor: pointer;
    transition: background-color 0.3s;
}

.indicator.active {
    background-color: rgba(255, 255, 255, 0.9);
}




.intro-paragraph-standalone {
    position: relative;
    padding: 0 40px;
    margin: 0 auto 35px;
    text-align: center;
    max-width: 900px;
}

.intro-paragraph-standalone p {
    color: rgba(255, 255, 255, 0.9);
    font-size: 17px;
    line-height: 1.7;
    font-weight: 400;
    font-style: italic;
}


/* Welcome Section Styles */
.welcome-section {
    margin-bottom: 40px;
    position: relative;
}

.welcome-header {
    text-align: center;
    margin-bottom: 25px;
    position: relative;
}

.welcome-title-area {
    display: inline-block;
    position: relative;
}

.welcome-section h1 {
    font-size: 38px;
    font-weight: 700;
    margin-bottom: 5px;
    color: white;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    display: inline-block;
    padding: 0 15px;
    position: relative;
    z-index: 1;
}

.accent-line {
    height: 4px;
    width: 80px;
    background: linear-gradient(90deg, transparent, #00aaff, transparent);
    margin: 0 auto;
    position: relative;
    border-radius: 2px;
}

.guidance-container {
    background: rgba(255, 255, 255, 0.12);
    border-radius: 16px;
    padding: 35px;
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.2),
        0 0 10px rgba(255, 255, 255, 0.1) inset;
    position: relative;
    overflow: hidden;
}

.guidance-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
}

.guidance-content {
    max-width: 900px;
    margin: 0 auto;
    position: relative;
}

.intro-paragraph {
    position: relative;
    padding: 0 40px;
    margin-bottom: 35px;
    text-align: center;
}

.intro-paragraph p {
    color: rgba(255, 255, 255, 0.9);
    font-size: 17px;
    line-height: 1.7;
    font-weight: 400;
    font-style: italic;
}

.highlight-quote {
    font-size: 60px;
    line-height: 0;
    position: absolute;
    color: rgba(0, 170, 255, 0.3);
    font-family: Georgia, serif;
    height: 30px;
}

.highlight-quote:first-child {
    top: 15px;
    left: 10px;
}

.highlight-quote:last-child {
    bottom: -5px;
    right: 10px;
}

.usage-instructions {
    display: flex;
    gap: 25px;
    margin-bottom: 30px;
}

.instruction-item {
    flex: 1;
    display: flex;
    gap: 15px;
    background: rgba(0, 0, 0, 0.2);
    padding: 25px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    align-items: flex-start;
    text-align: left;
    transition: transform 0.3s, box-shadow 0.3s;
    position: relative;
    overflow: hidden;
}

.instruction-item::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #007bff, #00aaff);
    transform: scaleX(0.3);
    transform-origin: left;
    transition: transform 0.5s;
}

.instruction-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
}

.instruction-item:hover::after {
    transform: scaleX(1);
}

.instruction-icon-wrapper {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #007bff, #00aaff);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 5px 15px rgba(0, 123, 255, 0.4);
}

.instruction-icon-wrapper i {
    font-size: 22px;
    color: white;
}

.instruction-text {
    flex: 1;
}

.instruction-text h3 {
    font-size: 20px;
    margin-bottom: 10px;
    color: white;
    position: relative;
    display: inline-block;
}

.instruction-text p {
    color: rgba(255, 255, 255, 0.85);
    font-size: 15px;
    line-height: 1.6;
    margin-bottom: 15px;
}

.feature-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.feature-tag {
    background: rgba(0, 170, 255, 0.15);
    color: rgba(255, 255, 255, 0.95);
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 30px;
    display: inline-block;
    font-weight: 500;
    border: 1px solid rgba(0, 170, 255, 0.3);
}

.start-prompt {
    text-align: center;
    margin-top: 20px;
}

.prompt-content {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background: rgba(255, 255, 255, 0.1);
    padding: 10px 20px;
    border-radius: 30px;
}

.prompt-content i {
    color: #00aaff;
    font-size: 18px;
}

.prompt-content p {
    color: white;
    font-size: 15px;
    margin: 0;
}

.pulse-animation {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% {
        transform: translateY(0);
        opacity: 1;
    }
    50% {
        transform: translateY(5px);
        opacity: 0.7;
    }
    100% {
        transform: translateY(0);
        opacity: 1;
    }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .usage-instructions {
        flex-direction: column;
    }
    
    .welcome-section h1 {
        font-size: 28px;
    }
    
    .guidance-container {
        padding: 25px 20px;
    }
    
    .intro-paragraph {
        padding: 0 20px;
    }
    
    .highlight-quote {
        font-size: 40px;
    }
    
    .highlight-quote:first-child {
        top: 5px;
        left: 0;
    }
    
    .highlight-quote:last-child {
        bottom: -15px;
        right: 0;
    }
}

/* This targets only the direct links in the main navigation bar */
.site-navigation > ul > li > a:hover {
    transform: scale(1.07) !important; /* Slightly increase size on hover */
    background-color: transparent !important; /* Ensure no background appears on hover */
}

/* This ensures the links are displayed correctly in the first place */
.site-navigation > ul > li > a {
    display: inline-block !important;
    color: white !important;
    text-decoration: none !important;
    padding: 8px 12px !important;
    visibility: visible !important;
    opacity: 1 !important;
}

.dropdown .dropdown-menu {
    display: none !important;
}

.dropdown:hover .dropdown-menu {
    display: block !important;
}

/* Dropdown styles */
.dropdown {
    position: relative;
}

.dropdown-toggle {
    cursor: pointer;
}

.dropdown-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 180px;
    background-color: #fff;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    border-radius: 4px;
    z-index: 1000;
    padding: 8px 0;
}

.dropdown-menu li {
    display: block;
    width: 100%;
    margin: 0;
}

.dropdown-menu li a {
    padding: 8px 16px;
    display: block;
    color: #333;
    text-decoration: none;
    transition: background-color 0.2s;
}

.dropdown-menu li a:hover {
    background-color: #f5f5f5;
}

.dropdown:hover .dropdown-menu {
    display: block;
}

/* Optional: Add a small arrow icon */
.fa-caret-down {
    margin-left: 5px;
    font-size: 14px;
}

html, body, button, input, select, textarea, div, p, h1, h2, h3, h4, h5, h6, a, span, label {
        font-family: 'Montserrat', sans-serif !important;
    }

.go-back-button {
    margin-top: 10px;
    background: linear-gradient(45deg, #6c757d, #495057);
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
    display: inline-block;
    width: 100%;
    box-sizing: border-box;
    font-size: 16px;
    text-align: center;
}

.go-back-button:hover {
    background: linear-gradient(45deg, #5a6268, #6c757d);
    box-shadow: 0 0 8px rgba(108, 117, 125, 0.7);
    transform: scale(1.05);
}

/* Add this to your CSS to reduce the space between navbar and form */
form#uploadForm {
    margin-top: -100px; /* Negative margin to pull the form up */
}

/* Video Header Styles */
.video-header {
    position: relative;
    height: auto; /* Change from fixed height to auto */
    min-height: 100px; /* Increase this value based on your logo size */
    width: 100%;
    overflow: visible; /* Change from hidden to visible */
}

/* Video Styling */
.background-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensures the video covers the entire header */
    z-index: -1; /* Puts the video behind the header content */
}

/* Header Content Styling */
.site-header {
    position: relative; /* Ensures the header content is above the video */
    color: white;
    padding: 0px 0;
    z-index: 1; /* Keeps the header content above the video */
}

/* Logo and Title Alignment */
.logo-title {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Navigation Styling */
.site-navigation ul {
    list-style: none;
    display: flex;
    gap: 20px;
    margin: 0;
    padding: 0;
}

.site-navigation a {
    color: white;
    text-decoration: none;
    font-size: 18px;
    padding: 8px 12px;
    border-radius: 4px;
    transition: transform 0.3s ease, color 0.3s ease;
}

.site-navigation a:hover {
    transform: scale(1.07); /* Slightly increase size on hover */
    background-color: transparent; /* Ensure no background appears on hover */
}


/* Logo and Site Title Alignment */
.logo-title {
    display: flex;
    align-items: center;
    gap: 12px; /* Spacing between logo and title */
}

/* Logo Styling */
.site-logo {
    height: 200px; /* Adjust logo height */
    width: auto; /* Maintain aspect ratio */
    object-fit: contain; /* Ensure the logo fits nicely */
}

/* Larger logo styling */
.logo-title .site-logo {
    height: 200px; /* Try a moderate increase first */
    max-height: 200px; /* Ensure it doesn't get too large */
}


#flaggedInstancesContainer {
    margin-top: 20px;
    height: 50px; /* Adjust height as needed */
    overflow: hidden;
    border: 1px solid #ccc;
    background-color: #fff;
    padding: 10px;
    border-radius: 5px;
    position: relative;
    white-space: nowrap; /* Ensure text stays on one line */
}

#flaggedInstancesListContainer {
    display: inline-block;
    white-space: nowrap;
    position: absolute; /* Enable animation */
    top: 50%; /* Center vertically */
    transform: translateY(-50%); /* Align to center */
}


.feedback-box button {
    display: block; /* Ensure button is block-level */
    width: 100%; /* Span full width of the parent */
    box-sizing: border-box; /* Include padding in width */
}


#distribution_channel {
    margin-bottom: 15px; /* Add spacing below the box */
}
#finalSection label {
    text-align: left; /* Align text to the left */
    display: block;
    margin-top: 10px;
    margin-bottom: 10px; /* Add padding below */
    width: 100%; /* Ensure labels span full width */
}

    /* Header Styles */
        .site-header {
            background: transparent; /* White */;
            color: white;
            padding: 40px 0;
            height: 100%;
	    z-index: 1;
        }
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px 20px; /* Add some padding top/bottom */
        }
        .site-title {
            font-family: 'Roboto Slab', serif; /* Replace with your chosen font */
	    font-size: 28px;
            font-weight: bold;
            margin: 0;
        }
        .site-navigation ul {
            list-style: none;
            display: flex;
            gap: 20px;
            margin: 0;
            padding: 0;
        }
        .site-navigation a {
            color: white;
            text-decoration: none;
            font-size: 18px;
            padding: 8px 12px;
            border-radius: 4px;
            transition: transform 0.3s ease, color 0.3s ease;
        }
        .site-navigation a:hover {
            transform: scale(1.05);
            background-color: transparent;
        }


        body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #0b0d23, #004e98, #00aaff);
    color: #ffffff; /* Ensure text is readable on a dark background */
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh; /* So the gradient covers the full viewport */
}

        h1 {
    text-align: center;
    margin-top: 0px; /* Adds vertical space above the heading */
}
form {
    margin-top: 20px;
    max-width: 600px;
    width: 100%;
}

select[multiple] {
    width: 100%;
    height: auto;
    border: 2px solid #007bff;
    border-radius: 8px;
    padding: 10px;
    font-size: 16px;
    background-color: #f9f9f9;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    outline: none;
    appearance: none;
    cursor: pointer;
    overflow-y: auto;
    transition: border-color 0.3s, box-shadow 0.3s;
}

select[multiple]:focus {
    border-color: #0056b3;
    box-shadow: 0 0 5px rgba(0, 91, 187, 0.5);
}

/* Option styles for multi-select */
select[multiple] option {
    padding: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
    background-color: #ffffff;
    color: #333;
    cursor: pointer;
    transition: background-color 0.3s, color 0.3s;
}

/* Hover and checked option styling */
select[multiple] option:hover {
    background: linear-gradient(45deg, #007bff, #00aaff);
    color: #ffffff;
}

select[multiple] option:checked::before {
    content: "✔";
    color: #007bff;
    font-weight: bold;
    margin-right: 8px;
}

        input[type="file"], textarea {
    background-color: rgba(255, 255, 255, 0.2); /* Light gray with transparency */
    color: #ffffff; /* White text for readability */
    border: 1px solid #444; /* Subtle dark gray border */
    border-radius: 5px; /* Rounded corners for consistency */
    padding: 10px; /* Padding inside the input/textarea */
    font-size: 15px; /* Font size for input and textarea */
    font-family: Arial, sans-serif; /* Maintain your original font */
    margin-top: 15px; /* Spacing above the element */
    width: 100%; /* Full width for responsiveness */
    max-width: 500px; /* Limit maximum width */
    resize: none; /* Prevent resizing for textarea */
    box-sizing: border-box; /* Ensure padding doesn't affect width */
}

        .file-upload-box, .text-input-box {
    background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black background */
    border: none; /* Remove borders */
    color: #fff; /* White text for readability */
    border-radius: 10px; /* Rounded corners */
    padding: 20px; /* Internal spacing */
    margin-top: 10px; /* Space between elements */
    box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.5); /* Subtle shadow for depth */
    max-width: 600px; /* Limit maximum width */
    width: 100%; /* Full-width responsiveness */
    text-align: center; /* Center align all text and content inside */
    position: relative; /* Retain positioning for any additional effects */
    transition: box-shadow 0.3s ease, transform 0.3s ease; /* Smooth transitions */
}



        .file-upload-box:hover, .text-input-box:hover {
    border: none; /* neon bluish border */
    box-shadow: none;
    transform: scale(1.02);
    cursor: pointer;
}

        .file-upload-box.dimmed, .text-input-box.dimmed {
            background-color: #e9ecef;
            border-color: #c6c6c6;
            pointer-events: none;
            opacity: 0.6;
        }
        .hidden { display: none; }
        .or-divider { font-weight: bold; text-align: center; margin: 5px 0 5px; }
        .file-name { margin-top: 10px; font-weight: bold; color: #fff; }
        .analyze-button, .select-file-button {
            margin-top: 10px;
            background: linear-gradient(45deg, #007bff, #00aaff);
            color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            display: inline-block;
            width: 100%; /* Make the button fill the container width */
            box-sizing: border-box; /* Include padding in the width */
            font-size: 16px; /* Adjust font size for better proportions */
            text-align: center; /* Center the button text */
}

.select-file-button:hover {
    background: linear-gradient(45deg, #0056b3, #007bff);
    box-shadow: 0 0 8px rgba(0, 170, 255, 0.7); /* subtle aqua glow */
    transform: scale(1.05);
}
        }
        .analyze-button:hover, .select-file-button:hover { background-color: #0056b3; }
        .analyze-button { display: none; }
        .compliance-button {
    display: block; /* Make the button a block element */
    width: 100%; /* Match the width of the container */
    padding: 10px 15px;
    background: linear-gradient(45deg, #007bff, #00aaff);
    color: white;
    text-decoration: none;
    border-radius: 5px;
    text-align: center;
    font-size: 16px;
    cursor: pointer;
    border: none; /* Remove the border */
    box-sizing: border-box; /* Ensure padding doesn't affect width */
}
        .compliance-button:hover {
    background: linear-gradient(45deg, #0056b3, #007bff);
    box-shadow: 0 0 8px rgba(0, 170, 255, 0.7); /* subtle aqua glow */
    transform: scale(1.05);
}
        /* Spinner overlay */
        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.8);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            visibility: hidden; /* Initially hidden */
        }
        #loadingSpinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #007bff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        #loadingMessage {
            margin-top: 15px;
            font-size: 1.2em;
            color: #007bff;
            text-align: center;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
#distribution_channel:hover,
#distribution_method:hover {
    border-color: white; /* Darker blue border on hover */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Add a subtle shadow effect */
    transform: scale(1.02); /* Slightly enlarge the dropdown */
    cursor: pointer; /* Show pointer cursor */
}

/* Fix parent containers to prevent overlay clipping */
.usage-instructions,
.guidance-content,
.guidance-container,
.welcome-section {
    overflow: visible !important;
}

/* Make sure the boxes show hover effect properly */
.instruction-item:hover {
    transform: translateY(-5px);
    z-index: 10;
}

/* IMPORTANT: Final override for hover effect with "Click to use" text */
.instruction-item {
    cursor: pointer;
    position: relative;
    overflow: visible !important;
}

.instruction-item::after {
    content: "Click to use" !important;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 70, 145, 0.7) !important;
    color: white !important;
    font-size: 24px !important;
    font-weight: 600 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    opacity: 0;
    transition: opacity 0.3s ease;
    border-radius: 12px;
    pointer-events: none;
    z-index: 1000 !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

.instruction-item:hover::after {
    opacity: 1 !important;
    transform: none !important;
}

    </style>
</head>
<body>
<!-- Web Header -->
<div class="video-header">
    <video autoplay muted loop class="background-video">
        <source src="globe.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    <header class="site-header">
        <div class="header-container">
            <!-- Logo and Site Title -->
            <div class="logo-title">
                <img src="/logo.png" alt="Logo" class="site-logo">
            </div>



            <!-- Navigation -->
<nav class="site-navigation">
    <ul>
        <li>
            <a href="/">Compliance Check</a>   
        </li>
        <li>
            <a href="profile">Profile</a>
            
        </li>
        <li class="dropdown">
    <a href="#" class="dropdown-toggle">Admin <i class="fa fa-caret-down"></i></a>
    
    <ul class="dropdown-menu">
        <li><a href="/manage-disclosures">Disclosures</a></li>
        <li><a href="/assign-disclosures">Personalization</a></li>
        <li><a href="/training">System Training</a></li>
        <li><a href="/admin-access">Admin Access</a></li>
    </ul>
</li>
        <li>
            <a href="login">Logout</a>
            
        </li>
    </ul>
</nav>
        </div>
    </header>
</div>

<!-- Add this after the video-header and before the uploadForm -->
<div class="welcome-section">
    <div class="welcome-header">
        <div class="welcome-title-area">
            <h1>Welcome to the Advisor Growth Portal</h1>
            <div class="accent-line"></div>
        </div>
    </div>

<!-- Replace the intro paragraph with this carousel -->
<div class="message-carousel-container">
    <div class="message-carousel">
        <div class="carousel-slide active">Communicate with clarity and consistency...</div>
        <div class="carousel-slide">...in a way that isn't boring or cookie-cutter.</div>
        <div class="carousel-slide">Express yourself boldly and uniquely...</div>
        <div class="carousel-slide">...in a manner that doesn't put your professional credentials at risk.</div>
    </div>
    <div class="carousel-indicators">
        <span class="indicator active"></span>
        <span class="indicator"></span>
        <span class="indicator"></span>
        <span class="indicator"></span>
    </div>
</div>
    
    <div class="guidance-container">
        <div class="guidance-content">
            
            <div class="usage-instructions">
                <div class="instruction-item">
                    <div class="instruction-icon-wrapper">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <div class="instruction-text">
                        <h3>Upload File</h3>
                        <p>Designed for instant feedback on text longer than a couple of sentences. It provides suggested alternatives that aim to help clean up potentially non-compliant language.</p>
                        <div class="feature-tags">
                            <span class="feature-tag">Batch Processing</span>
                            <span class="feature-tag">Detailed Analysis</span>
                        </div>
                    </div>
                </div>
                
                <div class="instruction-item">
                    <div class="instruction-icon-wrapper">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="instruction-text">
                        <h3>Quick Check</h3>
                        <p>Use the Quick Check box for instant feedback on single sentence examples. Perfect for testing specific phrases before adding them to your longer communications.</p>
                        <div class="feature-tags">
                            <span class="feature-tag">Instant Feedback</span>
                            <span class="feature-tag">Phrase Testing</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="start-prompt">
                <div class="prompt-content">
                    <i class="fas fa-arrow-up pulse-animation"></i>
                    <p>Get Started by Uploading File or Entering Text in Quick Check</p>
                </div>
            </div>
        </div>
    </div>
</div>             
                



    <div id="loadingOverlay">
    <div id="loadingSpinner"></div>

    <!-- Progress Bar Section -->
<div id="progress-container" style="width: 50%; margin: 20px auto 0; background-color: #e0e0e0; border: 1px solid #d6d6d6; border-radius: 20px; height: 30px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
    <div id="progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #007bff, #0056b3); transition: width 0.3s ease;"></div>
</div>


<!-- Progress Text -->
<div id="progress-text" style="text-align: center; margin-top: 10px; font-size: 1.5em; color: #007bff; font-weight: bold;">Progress: 0%</div>

<!-- Loading Message -->
<div id="loadingMessage" style="text-align: center; margin-top: 10px; font-size: 1.3em; color: #333; font-weight: bold;">Checking File Type</div>

<!-- Flagged Instances Section -->
<div id="flaggedInstancesContainer" style="display: none; width: 50%; margin-top: 20px; height: 200px; overflow: hidden; border: 1px solid #ccc; background-color: #fff; padding: 10px; border-radius: 5px;">


    <h4>Flagged Instances (Preview)</h4>
    <div id="flaggedScrollContainer" style="display: none; position: relative; height: 100%; overflow: hidden;">
        <ul id="flaggedInstancesListContainer" style="list-style: none; padding: 0; margin: 0; position: absolute;"></ul>
    </div>
</div>


    <!-- Loading Message and Percentage -->
    <div id="loadingMessage" style="display: none; text-align: center; margin-top: 10px;"></div>
    <div id="loadingPercentage" style="display: none; margin-top: 10px; font-size: 1.5em; color: #007bff;"></div>
</div>

    <form id="uploadForm" action="/" method="POST" enctype="multipart/form-data" onsubmit="return handleFormSubmit(event)">
    <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
    <h2 style="text-align: center; font-size: 32px;"></h2>

    <div class="file-upload-box" id="fileUploadBox">
        <label for="file" style="color: #00aaff; font-size: 1.3em;">
  <strong>Select or Drop Files Here</strong>
</label>
        <input type="file" id="file" name="file" style="display: none;">
        <p id="dragDropText" style="border: 2px dotted #00aaff; padding: 60px 10px; border-radius: 5px;">
    Drop (PDF) file here
</p>

        <div id="fileName" class="file-name" style="display: none;"></div>
        <button type="button" class="select-file-button" id="selectFileButton" onclick="selectFileAndSubmit()">Select File</button>
        <button type="button" onclick="analyzeFileDirectly()" class="analyze-button" id="fileAnalyzeButton">Analyze</button>
        <button type="button" onclick="goBack()" class="go-back-button" id="goBackButton" style="display: none;">Go Back</button>
    </div>

    <div class="or-divider" id="orDivider" style="margin: 3px 0;">OR</div>

    <div class="text-input-box" id="textInputBox">
        <label for="text_input" style="color: #00aaff; font-size: 1.2em;">
  <strong>Single Sentence Quick Check</strong>
</label>

        <textarea 
    id="text_input" 
    name="text_input" 
    rows="8"
    color: #ffffff;
    placeholder="Type or paste instance here..." 
    style="background-color: rgba(255, 255, 255, 0.2); color: white; border: 1px solid #444; border-radius: 5px; padding: 10px; font-size: 16px;">
</textarea>

        <button type="button" onclick="analyzeTextForCompliance()" class="analyze-button" id="textAnalyzeButton">Analyze</button>
        <div id="complianceResults" style="display: none; margin-top: 10px; text-align: left;"></div>
    </div>
</div>

        <div id="finalSection" style="display: none; text-align: center;">
<label for="distribution_channel"><strong>Select Distribution Method(s)</strong></label>
<select id="distribution_channel" name="distribution_channel[]" multiple required>
    <option value="social_media">Social Media</option>
    <option value="my_website">My Website</option>
    <option value="external_outlet">External Outlet (Newspaper, TV, Broadcast, Other Site, etc.)</option>
    <option value="presentation">Presentation, Handout, or Form</option>
    <option value="mail_or_email">Mail or Email</option>
    <option value="other">Other</option>
</select>

            <label for="distribution_method"><strong>Select Final Intended Format(s)</strong></label>
<select id="distribution_method" name="distribution_method[]" multiple required>
    <option value="Written Social Media Post">Written Social Media Post</option>
    <option value="Video">Video</option>
    <option value="Audio">Audio</option>
    <option value="Advertisement">Advertisement</option>
    <option value="Graphic or Logo">Graphic or Logo</option>
    <option value="Article, Newsletter, Press Release or Script">Article, Newsletter, Press Release or Script</option>
    <option value="Brochure, Flyer, Handout, Slideshow, Letter, or Message">Brochure, Flyer, Handout, Slideshow, Letter, or Message</option>
    <option value="Website Content">Website Content</option>
    <option value="Book or Booklet">Book or Booklet</option>
    <option value="Other">Other</option>
</select>
            <button type="submit" class="compliance-button" style="margin-top: 20px;">Upload and Check Compliance</button>
        </div>
    </form>

    <script>

// Add this function to close all modals before opening a new one
function closeAllModals() {
    const allModals = document.querySelectorAll('.modal-overlay');
    allModals.forEach(modal => {
        modal.classList.remove('active');
    });
}

// Add this to handle the modal overlay functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Get elements
        const fileUploadBox = document.getElementById('fileUploadBox');
        const textInputBox = document.getElementById('textInputBox');
        const orDivider = document.getElementById('orDivider');
        const fileInput = document.getElementById('file');
        const textArea = document.getElementById('text_input');
        
        // Create modal containers
        const fileUploadModal = document.createElement('div');
        fileUploadModal.className = 'modal-overlay';
        fileUploadModal.id = 'fileUploadModal';
        
        const textInputModal = document.createElement('div');
        textInputModal.className = 'modal-overlay';
        textInputModal.id = 'textInputModal';
        
        // Create modal content containers
        const fileModalContent = document.createElement('div');
        fileModalContent.className = 'modal-content';
        
        const textModalContent = document.createElement('div');
        textModalContent.className = 'modal-content';
        
        // Create close buttons
        const closeFileModal = document.createElement('button');
        closeFileModal.className = 'close-modal';
        closeFileModal.innerHTML = '<i class="fas fa-times"></i>';
        closeFileModal.addEventListener('click', function() {
            fileUploadModal.classList.remove('active');
        });
        
        const closeTextModal = document.createElement('button');
        closeTextModal.className = 'close-modal';
        closeTextModal.innerHTML = '<i class="fas fa-times"></i>';
        closeTextModal.addEventListener('click', function() {
            textInputModal.classList.remove('active');
        });
        
        // Set up modal structure
        fileModalContent.appendChild(closeFileModal);
        textModalContent.appendChild(closeTextModal);
        
        // Move the boxes to the modals
        document.body.appendChild(fileUploadModal);
        document.body.appendChild(textInputModal);
        
        // Function to show file upload modal
        function showFileUploadModal() {

            closeAllModals(); // Close any open modals first

            // Move the file upload box to the modal content
            fileModalContent.appendChild(fileUploadBox);
            fileUploadModal.appendChild(fileModalContent);
            
            // Make sure file input is enabled
            fileInput.disabled = false;
            fileUploadBox.classList.remove('dimmed');
            
            // Display the modal
            fileUploadBox.style.display = 'block';
            fileUploadModal.classList.add('active');
            
            // Add animation
            fileUploadBox.classList.add('fade-in');
            setTimeout(() => fileUploadBox.classList.remove('fade-in'), 1000);
        }
        
        // Function to show text input modal
        function showTextInputModal() {
            // Move the text input box to the modal content
            textModalContent.appendChild(textInputBox);
            textInputModal.appendChild(textModalContent);
            
            // Make sure text area is enabled
            textArea.disabled = false;
            textInputBox.classList.remove('dimmed');
            
            // Display the modal
            textInputBox.style.display = 'block';
            textInputModal.classList.add('active');
            
            // Add animation
            textInputBox.classList.add('fade-in');
            setTimeout(() => textInputBox.classList.remove('fade-in'), 1000);
        }
        
        // Get instruction items
        const uploadFileSection = document.querySelector('.instruction-item:first-child');
        const quickCheckSection = document.querySelector('.instruction-item:last-child');
        
        // Add click event to Upload File section
        uploadFileSection.addEventListener('click', showFileUploadModal);
        
        // Add click event to Quick Check section
        quickCheckSection.addEventListener('click', showTextInputModal);
        
        // Hide the original containers
        fileUploadBox.style.display = 'none';
        textInputBox.style.display = 'none';
        orDivider.style.display = 'none';
        
        // Override form submission to close the modals
        const originalHandleFormSubmit = window.handleFormSubmit;
        if (originalHandleFormSubmit) {
            window.handleFormSubmit = function(event) {
                fileUploadModal.classList.remove('active');
                textInputModal.classList.remove('active');
                return originalHandleFormSubmit(event);
            };
        }
        
        // Override analyzeTextForCompliance but DON'T close the modal
const originalAnalyzeTextForCompliance = window.analyzeTextForCompliance;
if (originalAnalyzeTextForCompliance) {
    window.analyzeTextForCompliance = async function() {
        await originalAnalyzeTextForCompliance();
        // Don't close the modal after analysis
    };
}
        
        // Override analyzeFileDirectly to close the modal
        const originalAnalyzeFileDirectly = window.analyzeFileDirectly;
        if (originalAnalyzeFileDirectly) {
            window.analyzeFileDirectly = function() {
                fileUploadModal.classList.remove('active');
                return originalAnalyzeFileDirectly();
            };
        }
        
        // Modify the switch input buttons to switch between modals
        document.addEventListener('click', function(e) {
            if (e.target && e.target.classList.contains('switch-input-button')) {
                if (e.target.closest('#fileUploadBox')) {
                    fileUploadModal.classList.remove('active');
                    setTimeout(() => {
                        showTextInputModal();
                    }, 300);
                } else if (e.target.closest('#textInputBox')) {
                    textInputModal.classList.remove('active');
                    setTimeout(() => {
                        showFileUploadModal();
                    }, 300);
                }
            }
        });
        
        // Allow clicking outside the modal to close it
        fileUploadModal.addEventListener('click', function(e) {
            if (e.target === fileUploadModal) {
                fileUploadModal.classList.remove('active');
            }
        });
        
        textInputModal.addEventListener('click', function(e) {
    // Do nothing when clicking outside the modal
    // This prevents the Quick Check box from closing when clicking outside
});
    });


// Add this to conditionally hide Admin dropdown based on user permissions
document.addEventListener('DOMContentLoaded', async function() {
    try {
        // Fetch the current user's data
        const response = await fetch('/api/current-user');
        if (!response.ok) {
            throw new Error('Failed to fetch user data');
        }

        const user = await response.json();
        
        // Check if the user has admin access
        const hasAdminAccess = user["Administrator Access NEW"] === "Yes";
        
        // Get the Admin dropdown element
        const adminDropdown = document.querySelector('.site-navigation ul li.dropdown');
        
        // Hide the Admin dropdown if user doesn't have admin access
        if (!hasAdminAccess && adminDropdown) {
            adminDropdown.style.display = 'none';
        }
    } catch (error) {
        console.error('Error checking admin status:', error);
        // Hide Admin dropdown by default if there's an error
        const adminDropdown = document.querySelector('.site-navigation ul li.dropdown');
        if (adminDropdown) {
            adminDropdown.style.display = 'none';
        }
    }
});

function goBack() {
    // Clear the file input
    const fileInput = document.getElementById('file');
    fileInput.value = '';
    
    // Hide file name display
    const fileNameDisplay = document.getElementById('fileName');
    fileNameDisplay.style.display = 'none';
    fileNameDisplay.textContent = '';
    
    // Enable text input box
    const textInputBox = document.getElementById('textInputBox');
    textInputBox.classList.remove('dimmed');
    const textArea = document.getElementById('text_input');
    textArea.disabled = false;
    
    // Hide analyze and go back buttons, show select file button
    const fileAnalyzeButton = document.getElementById('fileAnalyzeButton');
    fileAnalyzeButton.style.display = 'none';
    const goBackButton = document.getElementById('goBackButton');
    goBackButton.style.display = 'none';
    const selectFileButton = document.getElementById('selectFileButton');
    selectFileButton.style.display = 'inline-block';
    
    // Show drag and drop text
    const dragDropText = document.getElementById('dragDropText');
    dragDropText.style.display = 'block';
}

function analyzeFileDirectly() {
    // Get the file
    const fileInput = document.getElementById('file');
    if (!fileInput.files.length) {
        alert('Please select a file to analyze.');
        return;
    }
    
    // Show loading overlay
    loadingOverlay.style.visibility = 'visible';
    
    // Reset progress bar
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');
    progressBar.style.width = '0%';
    progressText.innerText = 'Progress: 0%';
    
    // Create FormData
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    
    // Upload the file first to get a filename for tracking
    fetch('/upload_file', { 
        method: 'POST', 
        body: formData 
    })
    .then(response => response.json())
    .then(data => {
        if (data.filename) {
            console.log(`File uploaded for analysis: ${data.filename}`);
            
            // Start tracking progress
            const trackingComplete = trackProgress(data.filename);
            
            // Show progress for at least 3 seconds before redirecting
            setTimeout(() => {
                // Create a new FormData for the main analysis request
                const analysisFormData = new FormData();
                analysisFormData.append('file', fileInput.files[0]);
                analysisFormData.append('distribution_channel', JSON.stringify(['social_media']));
                analysisFormData.append('distribution_method', JSON.stringify(['Written Social Media Post']));
                
                // Submit the form data - this goes directly to results page
                fetch("/", {
                    method: "POST",
                    body: analysisFormData
                })
                .then(response => {
                    if (response.redirected) {
                        window.location.href = response.url;
                    } else {
                        return response.text().then(text => {
                            throw new Error('Server returned: ' + text);
                        });
                    }
                })
                .catch(error => {
                    console.error("Error analyzing file:", error);
                    loadingOverlay.style.visibility = 'hidden';
                    alert('An error occurred while analyzing the file: ' + error.message);
                });
            }, 3000); // Wait 3 seconds to allow progress to display
            
        } else {
            throw new Error('File upload failed.');
        }
    })
    .catch(error => {
        console.error("Error analyzing file:", error);
        loadingOverlay.style.visibility = 'hidden';
        alert('An error occurred while analyzing the file: ' + error.message);
    });
}
function selectFileAndSubmit() {
    // Create a temporary file input element
    const tempFileInput = document.createElement('input');
    tempFileInput.type = 'file';
    tempFileInput.accept = '.pdf';
    
    // When a file is selected
    tempFileInput.onchange = function() {
        if (this.files.length > 0) {
            // Set the file in the form's file input
            const formFileInput = document.getElementById('file');
            formFileInput.files = this.files;
            
            // Update UI to show the file name
            handleFileUpload();
            
            // Analyze the file directly
            // analyzeFileDirectly();
        }
    };
    
    // Trigger the file selection dialog
    tempFileInput.click();
}

document.getElementById('uploadForm').addEventListener('submit', function (e) {
    e.preventDefault();
    const fileInput = document.getElementById('file');
    
    if (!fileInput.files.length) {
        alert('Please select a file to upload.');
        return;
    }
    
    const formData = new FormData(this);
    console.log('File uploaded:', fileInput.files[0].name);

    fetch('/upload_file', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        console.log('Upload Success:', data);
        alert('Upload successful!');
    })
    .catch(error => {
        console.error('Upload Error:', error);
        alert('Upload failed. Please try again.');
    });
});

// Function to redirect to profile
function goToProfile() {
    window.location.href = '/profile';
}

// Function to redirect to billing
function goToBilling() {
    window.location.href = '/profile'; // Adjust the URL to match your billing route
}

// Retrieve and log the logged-in user
const loggedInUser = localStorage.getItem('loggedInUser');

if (loggedInUser) {
    console.log(`Logged-in user: ${loggedInUser}`);
} else {
    console.log('No user is currently logged in.');
}


// Function to update the progress message
    const messages = [
        "Checking File Type",
        "Evaluating Sentence Structure",
        "Analyzing for Compliance Issues",
        "Finalizing Evaluation"
    ];
    let currentMessageIndex = 0;

    function cycleMessages() {
        const loadingMessage = document.getElementById("loadingMessage");
        loadingMessage.textContent = messages[currentMessageIndex];
        currentMessageIndex = (currentMessageIndex + 1) % messages.length;
    }

    // Cycle messages every 3 seconds
    setInterval(cycleMessages, 3000);





document.getElementById('uploadForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const formData = new FormData(this);
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');

    // Reset progress bar
    progressBar.style.width = '0%';
    progressText.innerText = 'Progress: 0%';

    // Upload file and start progress tracking
    fetch('/upload_file', { method: 'POST', body: formData })
        .then(response => response.json())
        .then(data => {
            if (data.filename) {
                console.log(`File uploaded: ${data.filename}`);
                trackProgress(data.filename); // Start progress tracking
            } else {
                progressText.innerText = 'Error: File upload failed.';
            }
        })
        .catch(error => {
            console.error('Error uploading file:', error);
            progressText.innerText = 'Error uploading file.';
        });
});

function trackProgress(filename) {
    const progressUrl = `/progress/${encodeURIComponent(filename)}`;
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');
    const flaggedInstancesList = document.getElementById('flaggedInstancesListContainer');
    // Removed the terminal feed container reference
    let finalFlaggedFound = false;
    let isSimulatingProgress = false;

    const eventSource = new EventSource(progressUrl);

    eventSource.onmessage = function (event) {
        const data = event.data.trim();
        console.log('Received data:', data);

        // Add flagged instance to the list
        if (data.startsWith("Flagged Instance:")) {
            const flaggedItem = document.createElement('li');
            flaggedItem.textContent = data.replace("Flagged Instance:", "").trim();
            flaggedInstancesList.appendChild(flaggedItem);
        }

        // Detect final flagged instance signal
        if (data === "Final Flagged Instances Found") {
            console.log("Final flagged instances detected!");
            finalFlaggedFound = true;

            // Stop simulated progress immediately
            isSimulatingProgress = false;

            // Pause for 2 seconds before rendering completion
            setTimeout(() => {
                progressBar.style.width = `100%`;
                progressText.innerText = 'Processing Complete!';
                eventSource.close();
            }, 2000); // 2-second delay
        }

        // Update progress bar
        const progress = parseFloat(data);
        if (!isNaN(progress)) {
            progressBar.style.width = `${progress}%`;
            progressText.innerText = `Progress: ${progress.toFixed(2)}%`;

            if (progress >= 60 && progress < 90 && !isSimulatingProgress && !finalFlaggedFound) {
                // Stop simulating progress if backend updates are detected
                isSimulatingProgress = true;
            }
            // Removed the code that displays the terminal feed
        }

        // Stop the EventSource when progress reaches 100%
        if (progress === 100) {
            eventSource.close();
        }
    };

    eventSource.onerror = function () {
        console.error('Error connecting to progress endpoint.');
        if (!finalFlaggedFound) {
            progressText.innerText = 'Error tracking progress.';
        }
        eventSource.close();
    };

    function simulateProgress(progressBar, progressText) {
        let simulatedProgress = 60;

        const interval = setInterval(() => {
            if (!isSimulatingProgress || finalFlaggedFound) {
                clearInterval(interval);
                return;
            }

            simulatedProgress += 2;
            if (simulatedProgress >= 90) {
                clearInterval(interval);
                return;
            }

            progressBar.style.width = `${simulatedProgress}%`;
            progressText.innerText = `Progress: ${simulatedProgress}%`;
        }, 2500); // Increase progress by 2% every 2.5 seconds
    }
}
async function analyzeTextForCompliance() {
    const textInput = document.getElementById("text_input").value.trim();
    const resultsDiv = document.getElementById("complianceResults");
    const textAnalyzeButton = document.getElementById("textAnalyzeButton");

    // Hide the analyze button when clicked
    textAnalyzeButton.style.display = "none";
    
    resultsDiv.style.display = "none";
    resultsDiv.innerHTML = "";

    if (!textInput) {
        resultsDiv.textContent = "Please enter text to analyze.";
        resultsDiv.style.display = "block";
        return;
    }

    try {
        // Use the existing check_custom_alternative endpoint
        const response = await fetch("/check_custom_alternative", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ custom_text: textInput }),
        });

        if (!response.ok) {
            throw new Error("Failed to fetch compliance check results.");
        }

        const data = await response.json();
        
        // Create result container
        const resultContainer = document.createElement("div");
        resultContainer.className = "compliance-result";
        
        // Add message
        const messageElement = document.createElement("p");
        messageElement.innerHTML = data.message || (data.compliant ? "No issues identified." : "<strong>Potential compliance issues identified.</strong>");
        resultContainer.appendChild(messageElement);
        
        // Add button
        const button = document.createElement("button");
        button.style.marginTop = "10px";
        button.style.padding = "10px 15px";
        button.style.border = "none";
        button.style.borderRadius = "5px";
        button.style.color = "#fff";
        button.style.cursor = "pointer";
        button.style.width = "100%";
        button.style.boxSizing = "border-box";
        
        if (data.compliant) {
            button.textContent = "Appears Compliant";
            button.style.backgroundColor = "#28a745";
        } else {
            button.textContent = "Not Compliant";
            button.style.backgroundColor = "#dc3545";
        }
        
        resultContainer.appendChild(button);
        
        // Add to results div
        resultsDiv.appendChild(resultContainer);
        resultsDiv.style.display = "block";
        
    } catch (error) {
        console.error("Error during compliance check:", error);
        resultsDiv.textContent = "An error occurred. Please try again.";
        resultsDiv.style.display = "block";
        // Show analyze button again on error
        textAnalyzeButton.style.display = "inline-block";
    }
}

        const fileUploadBox = document.getElementById('fileUploadBox');
        const fileInput = document.getElementById('file');
        const fileNameDisplay = document.getElementById('fileName');
        const selectFileButton = document.getElementById('selectFileButton');
        const textInputBox = document.getElementById('textInputBox');
        const textArea = document.getElementById('text_input');
        const fileAnalyzeButton = document.getElementById('fileAnalyzeButton');
        const textAnalyzeButton = document.getElementById('textAnalyzeButton');
        const finalSection = document.getElementById('finalSection');
        const orDivider = document.getElementById('orDivider');
        const dragDropText = document.getElementById('dragDropText');
        const uploadForm = document.getElementById('uploadForm');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const loadingMessage = document.getElementById('loadingMessage');
        
        const loadingSteps = [
            "Checking File Type",
            "Evaluating Sentence Structure",
            "Analyzing for Compliance Issues",
            "Finalizing Evaluation"
        ];
        let stepIndex = 0;

        // Drag-and-drop events for file upload
        fileUploadBox.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadBox.classList.add('dragover');
        });

        fileUploadBox.addEventListener('dragleave', () => fileUploadBox.classList.remove('dragover'));

        fileUploadBox.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadBox.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                fileInput.files = e.dataTransfer.files;
                handleFileUpload();
            }
        });

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                handleFileUpload();
            }
        });

        function handleFileUpload() {
    const fileName = fileInput.files[0].name;
    fileNameDisplay.style.display = 'block';
    fileNameDisplay.textContent = `Attached file: ${fileName}`;
    // Remove these two lines that affect the text input box
    // textInputBox.classList.add('dimmed');
    // textArea.disabled = true;
    fileAnalyzeButton.style.display = 'inline-block';
    selectFileButton.style.display = 'none';
    dragDropText.style.display = 'none';

    // Display the Go Back button
    const goBackButton = document.getElementById('goBackButton');
    goBackButton.style.display = 'inline-block';
}

        textArea.addEventListener('input', () => {
    // First, hide the compliance results if they're visible
    document.getElementById('complianceResults').style.display = 'none';
    
    // Only show/hide the analyze button based on text content
    if (textArea.value.trim() !== "") {
        // Always show the Analyze button when there's text in the textarea
        textAnalyzeButton.style.display = 'inline-block';
    } else {
        textAnalyzeButton.style.display = 'none';
    }
});

        function triggerInstantHide() {
            fileUploadBox.classList.add('hidden');
            textInputBox.classList.add('hidden');
            orDivider.classList.add('hidden');
            finalSection.style.display = 'block';
        }

        async function handleFormSubmit(event) {
    event.preventDefault();
    loadingOverlay.style.visibility = 'visible';  // Show spinner
    const loadingPercentage = document.getElementById('loadingPercentage');
    let progress = 0;
    loadingMessage.textContent = loadingSteps[stepIndex]; // Start with the first message
    
    const interval = setInterval(() => {
    stepIndex++;
    progress = Math.floor((stepIndex / loadingSteps.length) * 100); // Calculate percentage
    loadingPercentage.textContent = `${progress}% Complete`; // Update the displayed percentage

    if (stepIndex < loadingSteps.length) {
        loadingMessage.textContent = loadingSteps[stepIndex];
    } else {
        clearInterval(interval); // Stop updating messages
    }
}, 1000); // Change message every second

    const distributionMethod = document.getElementById('distribution_method').value;
    if (!distributionMethod) {
        alert("Please select a distribution method.");
        loadingOverlay.style.visibility = 'hidden';  // Hide spinner on error
        return false;
    }

    const formData = new FormData(); // Create FormData object

    formData.append('distribution_channel', JSON.stringify(getSelectedValues(document.getElementById('distribution_channel'))));

    // Add this block to log form data
    for (let [key, value] of formData.entries()) {
        console.log(key, value); // Log submitted keys and values
    }

    if (textArea.value.trim()) {
        const pdfFile = await convertTextToPDF();
        if (!pdfFile) {
            loadingOverlay.style.visibility = 'hidden';
            return false;
        }
        formData.append('file', pdfFile);
    } else if (fileInput.files.length > 0) {
        formData.append('file', fileInput.files[0]);
    } else {
        alert("Please upload a file or enter text to analyze.");
        loadingOverlay.style.visibility = 'hidden';
        return false;
    }

    formData.append('distribution_method', distributionMethod);

    fetch("/", { method: "POST", body: formData })
        .then(response => {
            if (response.redirected) {
                window.location.href = response.url;
            }
        })
        .catch(error => {
            console.error("Error submitting form:", error);
            loadingOverlay.style.visibility = 'hidden';
        });

    return false;
}

           
            document.getElementById('distribution_channel').addEventListener('change', function() {
    if (this.value === 'social_media') {
        localStorage.setItem('showComplianceLink', 'true');
    } else {
        localStorage.removeItem('showComplianceLink');
    }
});

            document.getElementById('distribution_method').addEventListener('change', function() {
    if (this.value === 'written_social_media_post') {
        localStorage.setItem('hideRevisedText', 'true');
    } else {
        localStorage.removeItem('hideRevisedText');
    }
});
            // Automatically toggle selection for multi-select dropdowns
function enableAutoMultiSelect(selectElement) {
    selectElement.addEventListener('mousedown', function(event) {
        event.preventDefault(); // Prevent default multi-select behavior
        const option = event.target;
        if (option.tagName === 'OPTION') {
            option.selected = !option.selected; // Toggle selection
            selectElement.dispatchEvent(new Event('change')); // Trigger change event
        }
    });
}

// Function to get selected values from a multi-select dropdown
function getSelectedValues(selectElement) {
    return Array.from(selectElement.selectedOptions).map(option => option.value);
}

// Initialize the multi-select dropdowns
function initializeMultiSelects() {
    const distributionChannel = document.getElementById('distribution_channel');
    const distributionMethod = document.getElementById('distribution_method');

    enableAutoMultiSelect(distributionChannel);
    enableAutoMultiSelect(distributionMethod);

    // Logging and localStorage updates on change
    distributionChannel.addEventListener('change', function () {
        const selectedChannels = getSelectedValues(this);
        console.log('Selected Channels:', selectedChannels);
        localStorage.setItem('selectedChannels', JSON.stringify(selectedChannels));
    });

    distributionMethod.addEventListener('change', function () {
        const selectedMethods = getSelectedValues(this);
        console.log('Selected Methods:', selectedMethods);
        localStorage.setItem('selectedMethods', JSON.stringify(selectedMethods));
    });
}

// Initialize everything
initializeMultiSelects();


document.addEventListener('DOMContentLoaded', async () => {
    const loggedInUser = localStorage.getItem('loggedInUser');

    if (loggedInUser) {
        console.log(`Logged-in user: ${loggedInUser}`);

        // Check subscription status
        try {
            const response = await fetch(`/api/check_subscription?email=${encodeURIComponent(loggedInUser)}`);
            const data = await response.json();

            if (data.showPaymentPopup) {
                // Display the payment overlay
                // Remove or condition this call if you want the date-based check to decide
     }

        } catch (error) {
            console.error('Error checking subscription:', error);
        }
    } else {
        console.log('No user is currently logged in.');
    }
});

// Function to redirect to billing
function goToBilling() {
    window.location.href = '/profile'; // Adjust to match your billing route
}


function goToBilling() {
    // Redirect to the billing section of the profile
    window.location.href = '/profile';
}



document.addEventListener('DOMContentLoaded', () => {
        const loggedInUser = "{{ user_email | safe }}";
        
	// Avoid redundant logs
    	if (window.alreadyLoggedUserCheck) return;
    	window.alreadyLoggedUserCheck = true;


	if (loggedInUser) {
            console.log(`Logged-in user: ${loggedInUser}`);
        } else {
            console.log('No user is logged in.');
        }
    });

document.addEventListener('DOMContentLoaded', () => {
    // Check if the user is newly registered
    if (localStorage.getItem('newlyRegistered') === 'true') {
        console.log('User just registered. Displaying payment details overlay.');

        // Display the payment overlay
        const paymentOverlay = document.getElementById('paymentDetailsOverlay');
        if (paymentOverlay) {
            
            console.log("Overlay should be visible.");
        }

        // Clear the flag to prevent re-showing
        localStorage.removeItem('newlyRegistered');
    }
});

document.addEventListener('DOMContentLoaded', () => {
    // Check if the user is logging in for the first time
    const loggedInUser = localStorage.getItem('loggedInUser');
    const firstTimeLoginKey = `${loggedInUser}_firstTimeLogin`;

    // If the flag is not set, it's the first login
    if (loggedInUser && !localStorage.getItem(firstTimeLoginKey)) {
        // Display the payment overlay
        const paymentOverlay = document.getElementById('paymentDetailsOverlay');
        console.log("Payment overlay is shown.");
        if (paymentOverlay) {
            
            console.log("Overlay should be visible.");
        }

        // Set the flag to avoid showing the overlay again
        localStorage.setItem(firstTimeLoginKey, 'false');
    }
});

// Function to redirect to billing
function goToBilling() {
    window.location.href = '/profile'; // Adjust URL to match your billing route
}



document.addEventListener('DOMContentLoaded', async () => {
    try {
        // Fetch the current user's data
        const response = await fetch('/api/current-user');
        if (!response.ok) {
            throw new Error('Failed to fetch user data');
        }

        const user = await response.json();

        // Check if the user is an Administrator
        if (user.Administrator === "Yes") {
            document.getElementById('adminTab').style.display = 'block'; // Show the Admin tab
        }
    } catch (error) {
        console.error('Error checking admin status:', error);
    }
});

// Add this to your Uploads HTML file
document.addEventListener('DOMContentLoaded', function() {
    // Check if advisor type has been selected
    if (localStorage.getItem('advisorTypeSelected') === 'true') {
        // Find and hide the popup
        const popup = document.querySelector('.your-popup-class-name'); // Replace with your actual popup class
        if (popup) {
            popup.style.display = 'none';
        }
    }
});

// Replace ALL of them with this single function:
function showOverlayIfNoAdvisorType() {
    const paymentOverlay = document.getElementById('paymentDetailsOverlay');
    
    // First, always show the overlay to ensure it appears
    paymentOverlay.style.display = 'block';
    
    // Disable all inputs except the "Go to Profile" button
    document.querySelectorAll('input, select, textarea, button').forEach(el => {
        if (el.id !== 'goToBillingButton') {
            el.disabled = true;
            el.style.pointerEvents = 'none';
        }
    });
    
    // Prevent scrolling
    document.body.style.overflow = 'hidden';
    
    // Then check if we need to hide it by fetching user data
    fetch('/api/current-user')
        .then(response => response.json())
        .then(user => {
            console.log("User data:", user);
            
            // Only hide overlay if user has an advisorType
            if (user.advisorType) {
                console.log("Advisor type found:", user.advisorType);
                paymentOverlay.style.display = 'none';
                
                // Re-enable all inputs
                document.querySelectorAll('input, select, textarea, button').forEach(el => {
                    el.disabled = false;
                    el.style.pointerEvents = 'auto';
                });
                
                // Allow scrolling
                document.body.style.overflow = 'auto';
            } else {
                console.log("No advisor type found - keeping overlay visible");
            }
        })
        .catch(error => {
            console.error("Error fetching user data:", error);
        });
}

// Make sure to REPLACE all existing DOMContentLoaded event listeners 
// that call overlay functions with just this ONE:
document.addEventListener('DOMContentLoaded', showOverlayIfNoAdvisorType);

// Carousel functionality with 6-second delay
document.addEventListener('DOMContentLoaded', function() {
    const slides = document.querySelectorAll('.carousel-slide');
    const indicators = document.querySelectorAll('.indicator');
    let currentSlide = 0;
    let intervalId; // Declare the interval variable outside to manage it better
    
    function showSlide(index) {
        // Hide all slides
        slides.forEach(slide => {
            slide.classList.remove('active');
        });
        
        // Remove active class from all indicators
        indicators.forEach(indicator => {
            indicator.classList.remove('active');
        });
        
        // Show current slide and indicator
        slides[index].classList.add('active');
        indicators[index].classList.add('active');
    }
    
    // Auto-rotate slides
    function rotateSlides() {
        currentSlide = (currentSlide + 1) % slides.length;
        showSlide(currentSlide);
    }
    
    // Set up click handlers for indicators
    indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => {
            currentSlide = index;
            showSlide(currentSlide);
            
            // Reset the rotation timer when manually clicking
            clearInterval(intervalId);
            intervalId = setInterval(rotateSlides, 6000); // Restart with 6-second delay
        });
    });
    
    // Start auto-rotation with 6-second delay
    intervalId = setInterval(rotateSlides, 6000);
    
    // Pause rotation when hovering over carousel
    const carousel = document.querySelector('.message-carousel-container');
    carousel.addEventListener('mouseenter', () => {
        clearInterval(intervalId);
    });
    
    carousel.addEventListener('mouseleave', () => {
        clearInterval(intervalId);
        // Restart the interval with 6-second delay
        intervalId = setInterval(rotateSlides, 6000);
    });
    
    // Show first slide initially
    showSlide(currentSlide);
});




// HERE





document.addEventListener('DOMContentLoaded', function() {
    console.log('Admin access check script loaded');
    
    // Function to check admin status and hide the Admin button if needed
    function checkAdminAccess() {
        console.log('Checking admin access...');
        
        // Get user data from storage or fetch it from the server
        fetch('/api/current-user')
            .then(response => response.json())
            .then(user => {
                console.log('User data received:', user);
                
                // Check if user data exists and the administrator access is "No"
                if (user && user["Administrator Access NEW"] === "No") {
                    console.log('User is not an admin, hiding admin button');
                    
                    // Hide the Admin dropdown - use !important to override other styles
                    const adminDropdown = document.getElementById('adminDropdown');
                    if (adminDropdown) {
                        adminDropdown.style.display = 'none !important';
                        // Also remove it from the DOM flow completely as a fallback
                        adminDropdown.classList.add('hidden-admin');
                    } else {
                        console.log('Admin dropdown element not found');
                    }
                } else {
                    console.log('User has admin access or data is incomplete');
                }
            })
            .catch(error => {
                console.error('Error checking admin access:', error);
            });
    }

    // Run the check when the page loads
    checkAdminAccess();
});


    </script>
</form>
<footer style="text-align: center; margin-top: 40px; padding: 10px; font-size: 14px; color: #333;">
    © 2025 Finalyze, LLC. All Rights Reserved.
</footer>
<!-- Usage Reached Overlay -->
<div id="usageReachedOverlay" 
     style="display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.6); 
            z-index: 99999;">
  <div style="position: absolute; 
              top: 50%; 
              left: 50%; 
              transform: translate(-50%, -50%); 
              background-color: #fff; 
              padding: 30px; 
              border-radius: 8px; 
              text-align: center; 
              width: 300px;
              color: #333;">
    <h2 style="margin-bottom: 10px;">Monthly Usage Reached</h2>
    <p style="margin-bottom: 20px;">Visit Profile, Usage Tracker to Continue</p>
    <button id="goToProfileButton"
            style="padding: 10px; 
                   border: none; 
                   border-radius: 4px; 
                   background-color: #007bff; 
                   color: #fff; 
                   cursor: pointer;"
            onclick="goToProfile()">
      Go to Profile
    </button>
  </div>
</div>
<!-- Payment Details Overlay -->
<div id="paymentDetailsOverlay" 
     style="display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.6); 
            z-index: 99999;">
  <div style="position: absolute; 
              top: 50%; 
              left: 50%; 
              transform: translate(-50%, -50%); 
              background-color: #fff; 
              padding: 30px; 
              border-radius: 8px; 
              text-align: center; 
              width: 300px;
              color: #333;">
    <h2 style="margin-bottom: 10px;">Complete Profile Details</h2>
    <p style="margin-bottom: 20px;">Visit Profile, Select Advisor Type to continue</p>
    <button id="goToBillingButton"
            style="padding: 10px; 
                   border: none; 
                   border-radius: 4px; 
                   background-color: #007bff; 
                   color: #fff; 
                   cursor: pointer;"
            onclick="goToBilling()">
      Go to Profile
    </button>
  </div>
</div>
</body>
</html>