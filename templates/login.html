<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login and Register</title>
    <style>


/* Space Background */
        .space-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(11, 13, 35, 0.7), rgba(0, 78, 152, 0.7), rgba(0, 170, 255, 0.7));
            z-index: -10;
            overflow: hidden;
        }

        /* Stars */
        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -9;
        }

        .star {
            position: absolute;
            background-color: #fff;
            border-radius: 50%;
            opacity: 0;
            animation: twinkle ease infinite;
        }

        @keyframes twinkle {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Replace your existing comet CSS with these updated styles */
.comet {
    position: absolute;
    pointer-events: none;
    z-index: -8;
    opacity: 0;
    transform-origin: center center;
}

.comet-head {
    position: absolute;
    width: 3px;
    height: 3px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.7);
    box-shadow: 0 0 6px 1px rgba(255, 255, 255, 0.2);
}

.comet-tail {
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    width: 40px;
    height: 1px;
    background: linear-gradient(to left, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.4));
}

@keyframes cometMove {
    0% {
        transform: translate(0, 0) rotate(var(--angle, 0deg));
        opacity: 0;
    }
    10% {
        opacity: var(--opacity, 0.3);
    }
    90% {
        opacity: var(--opacity, 0.3);
    }
    100% {
        transform: translate(var(--distance, 200px), var(--distance, 200px)) rotate(var(--angle, 0deg));
        opacity: 0;
    }
}

        /* Your original body background - now we'll overlay the space effect */
        body {
            font-family: 'Arial', sans-serif;
            color: #fff;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
        }

        /* Content container - place your login forms inside this */
        .content {
            position: relative;
            z-index: 1;
        }




/* Larger logo styling */
.logo-title .site-logo {
    height: 200px; /* Try a moderate increase first */
    max-height: 200px; /* Ensure it doesn't get too large */
}

.alert-box {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #333; /* Dark background for better contrast */
    color: #fff;
    padding: 20px 40px;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    display: none; /* Hidden by default */
    z-index: 1000;
    animation: fadeInOut 3s ease-in-out;
}

/* Improved fade-in and fade-out animation */
@keyframes fadeInOut {
    0% { opacity: 0; transform: translate(-50%, -60%); }
    10% { opacity: 1; transform: translate(-50%, -50%); }
    90% { opacity: 1; transform: translate(-50%, -50%); }
    100% { opacity: 0; transform: translate(-50%, -60%); }
}


#goToLogin {
    color: #00aaff; /* Default color */
    text-decoration: none;
    transition: color 0.3s ease;
}

#goToLogin:hover {
    color: #0056b3; /* Darker blue on hover */
}


/* Centered Alert Box */
.alert-box {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(0, 0, 0, 0.8); /* Semi-transparent black */
    color: #fff;
    padding: 20px 30px;
    border-radius: 10px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
    text-align: center;
    font-size: 18px;
    font-weight: bold;
    display: none; /* Hidden by default */
    z-index: 1000;
    animation: fadeInOut 3s ease-out;
}

/* Fade-in, fade-out animation */
@keyframes fadeInOut {
    0% { opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { opacity: 0; }
}

.container a {
    color: #1e90ff;
    text-decoration: none;
    transition: color 0.3s;
}

.container a:hover {
    color: #ff6a00; /* Same hover color as other links */
}


.main-container .container:nth-child(1) {
    cursor: pointer; /* Makes the Login box clickable */
}


.main-container .container:nth-child(2) {
    cursor: pointer; /* Makes the Register box clickable */
}


        /* General Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0b0d23, #004e98, #00aaff); /* Sexy gradient matching the logo */
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            flex-direction: column; /* Align logo on top */
        }

        /* Logo Container */
        .logo-container {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo-container img {
            max-width: 300px;
            height: auto;
        }

        /* Main Flexbox Container */
        .main-container {
            display: flex;
            gap: 20px; /* Space between login and registration boxes */
        }

        /* Box Styles */
        .container {
            background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black */
            width: 350px;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .container h2 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 28px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #00aaff; /* Light blue title color */
        }

        .container label {
            font-size: 14px;
            margin-bottom: 5px;
            display: block;
            font-weight: 500;
        }

        .container input {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: none;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            color: #fff;
            font-size: 16px;
        }

        .container input::placeholder {
            color: #ccc;
        }

        .container button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 5px;
            background: linear-gradient(45deg, #007bff, #00aaff); /* Blue gradient */
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .container button:hover {
            background: linear-gradient(45deg, #0056b3, #007bff);
            transform: scale(1.05);
        }

        .forgot-password,
        .register-button {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
        }

        .forgot-password a,
        .register-button a {
            color: #00aaff;
            text-decoration: none;
            transition: color 0.3s;
        }

        .forgot-password a:hover,
        .register-button a:hover {
            color: #007bff;
        }

        .register-button {
            margin-top: 10px;
        }
    </style>
</head>
<body>
<!-- Space Background -->
    <div class="space-background"></div>
    <div class="stars" id="starsContainer"></div>

    <!-- Content -->
    <div class="content">
        <!-- Your existing login/register content goes here -->
    </div>


    <!-- Logo Section -->
    <div class="logo-container">
        <img src="/logo.png" alt="Compliance Advisor 360 Logo">


    </div>

    <!-- Main Login and Register Section -->
    <div class="main-container">
        <!-- Login Box -->
        <div class="container">
            <h2>Login</h2>
            <form id="loginForm">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter your username" required>

                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required>

                <button type="button" onclick="submitLogin()">Login</button>

                <div class="forgot-password">
                    <a href="/reset-password">Forgot your password?</a>
                </div>

                <div class="register-button">
                    <a href="/login">No account? Register here</a>
                </div>
            </form>
        </div>

        <!-- Registration Box -->
        <div class="container">
            <h2>Register</h2>
            <form id="registerForm">
                <label for="fullName">Full Name</label>
                <input type="text" id="fullName" name="fullName" placeholder="Enter your full name" required>

                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Enter your email" required>

                <label for="newPassword">Password</label>
                <input type="password" id="newPassword" name="newPassword" placeholder="Create a password" required>

                <button type="button" onclick="submitRegister()">Register</button>
                <div class="login-instead" style="text-align: center; margin-top: 10px; font-size: 14px;">
    <a href="#" id="goToLogin" style="color: #1e90ff; text-decoration: none; transition: color 0.3s;">Already have an account? Login here</a>
</div>

            </form>
        </div>
    </div>

    <script>

// Function to play login success sound
function playLoginSuccessSound() {
    const sound = document.getElementById('loginSound');
    
    // Reset the sound in case it was playing
    sound.pause();
    sound.currentTime = 0;
    
    // Set volume (value between 0 and 1)
    sound.volume = 0.6;
    
    // Play the sound with a promise to handle any autoplay restrictions
    const playPromise = sound.play();
    
    if (playPromise !== undefined) {
        playPromise.catch(error => {
            console.warn('Audio playback was prevented by browser: ', error);
            // Most browsers require user interaction before playing audio
        });
    }
}

// Enable audio after user interaction
document.addEventListener('click', function() {
    const sound = document.getElementById('loginSound');
    
    // Just load the sound, don't play it yet
    sound.load();
    
    // This removes the event listener after the first click
    document.removeEventListener('click', arguments.callee);
}, { once: true });

// Create stars
        function createStars() {
            const starsContainer = document.getElementById('starsContainer');
            const starCount = 200; // Adjust number of stars
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                
                // Random position
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                
                // Random size (small to keep subtle)
                const size = Math.random() * 2;
                
                // Random twinkle duration
                const duration = 3 + Math.random() * 7;
                
                // Random delay
                const delay = Math.random() * 10;
                
                star.style.left = `${x}%`;
                star.style.top = `${y}%`;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.animationDuration = `${duration}s`;
                star.style.animationDelay = `${delay}s`;
                
                starsContainer.appendChild(star);
            }
        }
        
        // Replace your createComets function with this updated version:
function createComets() {
    function createComet() {
        const comet = document.createElement('div');
        comet.classList.add('comet');
        
        const cometHead = document.createElement('div');
        cometHead.classList.add('comet-head');
        
        const cometTail = document.createElement('div');
        cometTail.classList.add('comet-tail');
        
        comet.appendChild(cometHead);
        comet.appendChild(cometTail);
        
        // Random starting position anywhere on screen
        const startX = Math.random() * window.innerWidth;
        const startY = Math.random() * window.innerHeight;
        
        // Random direction (all 360 degrees possible)
        const angle = Math.random() * 360;
        
        // Much slower duration
        const duration = Math.random() * 8 + 7; // 7-15 seconds
        
        // Much smaller scale for subtlety
        const scale = Math.random() * 0.7 + 0.2; // 0.2-0.9 scale (smaller)
        
        // Lower opacity for subtlety
        const opacity = Math.random() * 0.4 + 0.1; // 0.1-0.5 opacity
        
        comet.style.left = `${startX}px`;
        comet.style.top = `${startY}px`;
        comet.style.transform = `rotate(${angle}deg)`;
        comet.style.transformOrigin = 'center center';
        
        // Add curved path with bezier curve animation
        const pathType = Math.floor(Math.random() * 3); // 3 different curve types
        let bezierPoints;
        
        if (pathType === 0) {
            // Gentle curve
            bezierPoints = '0.25, 1, 0.75, 1';
        } else if (pathType === 1) {
            // S-curve
            bezierPoints = '0.45, 0, 0.55, 1';
        } else {
            // Arc
            bezierPoints = '0.25, 0.1, 0.25, 1';
        }
        
        comet.style.animation = `cometMove ${duration}s cubic-bezier(${bezierPoints}) forwards`;
        
        // Make comet more subtle
        cometHead.style.transform = `scale(${scale})`;
        cometHead.style.opacity = opacity;
        cometTail.style.width = `${40 * scale}px`; // Shorter tail
        cometTail.style.opacity = opacity;
        
        document.body.appendChild(comet);
        
        // Remove comet after animation
        setTimeout(() => {
            comet.remove();
        }, duration * 1000);
    }
    
    // Longer intervals between comets
    function scheduleNextComet() {
        const delay = Math.random() * 6000 + 3000; // 3-9 seconds between comets
        setTimeout(() => {
            createComet();
            scheduleNextComet();
        }, delay);
    }
    
    // Start with a few comets
    for (let i = 0; i < 3; i++) {
        setTimeout(() => createComet(), Math.random() * 2000);
    }
    
    // Continue creating comets
    scheduleNextComet();
}
        
        // Initialize both stars and comets
        document.addEventListener('DOMContentLoaded', () => {
            createStars();
            createComets();
        });


function showPopup(message) {
    const alertBox = document.getElementById('alertBox');
    const alertMessage = document.getElementById('alertMessage');

    alertMessage.textContent = message;
    alertBox.style.display = 'block';

    // Automatically hide the popup after 3 seconds
    setTimeout(() => {
        alertBox.style.display = 'none';
    }, 3000);
}


document.getElementById('goToLogin').addEventListener('click', (event) => {
    event.preventDefault(); // Prevent default link behavior

    // Redirect to /login
    window.location.href = '/login';

    // Optional: Toggle visibility of login and register boxes
    const loginBox = document.querySelector('.main-container .container:nth-child(1)');
    const registerBox = document.querySelector('.main-container .container:nth-child(2)');

    if (loginBox && registerBox) {
        loginBox.style.display = 'block'; // Show the login box
        registerBox.style.display = 'none'; // Hide the register box
    }
});


function showAlert(message) {
    const alertBox = document.getElementById('alertBox');
    const alertMessage = document.getElementById('alertMessage');

    alertMessage.textContent = message; // Set the alert message
    alertBox.style.display = 'block';  // Show the alert

    // Automatically hide the alert after 3 seconds
    setTimeout(() => {
        alertBox.style.display = 'none';
    }, 3000);
}








        document.querySelector('.main-container .container:nth-child(1)').addEventListener('click', showOnlyLoginBox);

function showOnlyLoginBox() {
    const loginBox = document.querySelector('.main-container .container:nth-child(1)');
    const registerBox = document.querySelector('.main-container .container:nth-child(2)');

    if (loginBox && registerBox) {
        // Show the login box
        loginBox.style.display = 'block';
        loginBox.style.width = '450px';
        loginBox.style.margin = '0 auto';
        loginBox.style.boxShadow = '0 8px 20px rgba(0, 0, 0, 0.5)';

        // Hide the register box
        registerBox.style.display = 'none';
    } else {
        console.error('Login or Register box not found.');
    }
}

async function submitRegister() {
    const fullName = document.getElementById('fullName').value;
    const email = document.getElementById('email').value;
    const newPassword = document.getElementById('newPassword').value;

    if (fullName && email && newPassword) {
        try {
            const response = await fetch('/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ fullName, email, newPassword }),
            });

            const result = await response.json();
            if (response.ok) {
                console.log(`Registered and logged in user: ${email}`);

                // Set a flag to show the payment popup
                localStorage.setItem('showPaymentOverlay', 'true');

                // Show only the login box
                setTimeout(() => showOnlyLoginBox(), 100);
            } else {
                alert(result.error);
            }
        } catch (error) {
            console.error('Registration error:', error);
            alert('An error occurred during registration. Please try again.');
        }
    } else {
        alert("Please fill out all fields.");
    }
}


        document.querySelector('.main-container .container:nth-child(2)').addEventListener('click', showOnlyRegisterBox);

function showOnlyRegisterBox() {
    const loginBox = document.querySelector('.main-container .container:nth-child(1)');
    const registerBox = document.querySelector('.main-container .container:nth-child(2)');

    // Hide the login box
    loginBox.style.display = 'none';

    // Center and expand the register box
    registerBox.style.width = '450px';
    registerBox.style.margin = '0 auto';
    registerBox.style.boxShadow = '0 8px 20px rgba(0, 0, 0, 0.5)';
    registerBox.style.cursor = 'default'; // Disable pointer cursor after action
}



        async function submitLogin() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    if (username && password) {
        try {
            const response = await fetch('/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username, password }),
            });

            const result = await response.json();

            if (response.ok) {
                // Play login success sound
                playLoginSuccessSound();
                
                // Store the logged-in username in localStorage
                localStorage.removeItem('loggedInUser'); // Clear previous user info
                localStorage.setItem('loggedInUser', username);

                // Redirect to the intended page
                console.log(`Logged-in user: ${username}`);
                
                // Small delay to allow sound to play before redirect
                setTimeout(() => {
                    window.location.href = result.redirect_url;
                }, 800); // 800ms delay
            } else {
                console.error(result.error);
                alert(result.error); // Show an alert for errors instead of using a popup
            }
        } catch (error) {
            console.error('Login error:', error);
            alert('An error occurred during login. Please try again.');
        }
    } else {
        alert('Please fill in both username and password.');
    }
}

// Password reset functionality
document.getElementById('forgotPasswordLink').addEventListener('click', function(e) {
    e.preventDefault();
    document.getElementById('passwordResetModal').style.display = 'block';
    document.getElementById('resetStep1').style.display = 'block';
    document.getElementById('resetStep2').style.display = 'none';
    document.getElementById('resetEmail').value = '';
});

document.getElementById('closeResetModal').addEventListener('click', function(e) {
    e.preventDefault();
    document.getElementById('passwordResetModal').style.display = 'none';
});

document.getElementById('sendResetLink').addEventListener('click', async function() {
    const email = document.getElementById('resetEmail').value;
    
    if (!email) {
        showAlert('Please enter your email address');
        return;
    }
    
    try {
        // Here you would send a request to your backend to initiate the password reset
        // For demonstration, we'll simulate a successful request
        const response = await fetch('/reset-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email })
        });
        
        if (response.ok) {
            // Show success message
            document.getElementById('resetStep1').style.display = 'none';
            document.getElementById('resetStep2').style.display = 'block';
            
            // Close the modal after 5 seconds
            setTimeout(() => {
                document.getElementById('passwordResetModal').style.display = 'none';
            }, 5000);
        } else {
            const result = await response.json();
            showAlert(result.error || 'Failed to send reset link');
        }
    } catch (error) {
        console.error('Password reset error:', error);
        showAlert('An error occurred. Please try again later.');
    }
});

    </script>

<div id="alertBox" class="alert-box">
    <p id="alertMessage">Login Successful</p>
</div>

<footer style="text-align: center; margin-top: 20px; font-size: 14px; color: #555;">
        &copy; 2025 Finalyze, LLC. All Rights Reserved.
    </footer>
<!-- Password Reset Modal -->
<div id="passwordResetModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 1001;">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(0, 0, 0, 0.8); padding: 30px; border-radius: 10px; width: 350px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);">
        <h3 style="text-align: center; margin-bottom: 20px; color: #00aaff; font-size: 22px;">Reset Password</h3>
        <p style="color: #fff; margin-bottom: 20px; text-align: center;">Enter your email address and we'll send you a link to reset your password.</p>
        
        <div id="resetStep1">
            <input type="email" id="resetEmail" placeholder="Enter your email" style="width: 100%; padding: 10px; margin-bottom: 20px; border: none; border-radius: 5px; background-color: rgba(255, 255, 255, 0.2); color: #fff; font-size: 16px;">
            <button id="sendResetLink" style="width: 100%; padding: 12px; border: none; border-radius: 5px; background: linear-gradient(45deg, #007bff, #00aaff); color: #fff; font-size: 16px; font-weight: bold; cursor: pointer; transition: background 0.3s ease, transform 0.2s ease;">Send Reset Link</button>
        </div>
        
        <div id="resetStep2" style="display: none;">
            <p style="color: #fff; margin-bottom: 20px; text-align: center;">Please check your email for the password reset link.</p>
        </div>
        
        <div style="text-align: center; margin-top: 15px;">
            <a href="#" id="closeResetModal" style="color: #00aaff; text-decoration: none;">Cancel</a>
        </div>
    </div>
</div>

<!-- Audio elements for sound effects -->
<audio id="loginSound" preload="auto">
    <source src="https://assets.codepen.io/377401/success-login.mp3" type="audio/mpeg">
    <!-- Fallback sources if you want to host your own audio -->
    <!-- <source src="/sounds/login-success.mp3" type="audio/mpeg"> -->
    <!-- <source src="/sounds/login-success.ogg" type="audio/ogg"> -->
</audio>
</body>
</html>